<?xml version="1.0" encoding="UTF-8"?>

<!-- ==== mapper 기본설정 ==== -->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- ==== 루트 엘리먼트 & 네임스페이스 설정(프로젝트 전체내에서 유일해야 한다.) ==== -->
<mapper namespace="ksm">

	<select id="getTotalCount" parameterType="HashMap" resultType="Integer">
	    select count(*)
	    from tbl_member
	    <if test='searchType != "" and searchWord != "" '>
	    and lower(${searchType}) like '%'||lower(#{searchWord})||'%'
	    </if>	    
	</select>
	
	<select id="memberList" parameterType="HashMap" resultType="com.gukmo.board.model.MemberVO">
	select rnum, fk_userid as userid, email, email_acept, username, nickname, join_date, status, point
	from
	(
	select rownum as rnum, fk_userid, email, email_acept, username, nickname, join_date, status, point
	from 
	(
	select fk_userid, email, email_acept, username, nickname, join_date, status, point
	from tbl_member M
	left join tbl_member_login L
	on fk_userid = userid
	order by join_date desc
	) V
	) D
	where rnum between #{startRno} and #{endRno}
	</select>
	
</mapper>
